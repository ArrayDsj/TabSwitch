<project default="jar" name="TabSwitch">

  <property name="project.name" value="TabSwitch"/>

  <property name="build.dir" value="build"/>
  <property name="build.classes.dir" value="${build.dir}/classes"/>
  <property name="build.jars.dir" value="${build.dir}/jars"/>
  <property name="src.dir" value="src"/>
  <property name="src.testcases.dir" value="${src.dir}/testcases"/>

  <property name="jar.file" value="${project.name}.jar"/>
  <property name="idea.home" value="C:/Program Files/IDEA_Irida"/>
  <property name="idea.plugin.dir" value="${user.home}/.IntelliJIDEA/config/plugins"/>


  <path id="compile.classpath">
    <fileset dir="${idea.home}/lib">
      <include name="openapi.jar"/>
      <include name="idea.jar"/>
      <include name="jdom.jar"/>
    </fileset>
  </path>

  <path id="runtime.classpath">
    <path refid="compile.classpath"/>
    <pathelement location="${build.classes.dir}"/>
  </path>

  <target name="clean">
    <delete dir="${build.dir}"/>
  </target>

  <target name="echo-properties">
    <echo message="java.vm.version = ${java.vm.version}"/>
    <echo message="ant.version = ${ant.version}"/>
    <echo message="os.name = ${os.name}"/>
  </target>

  <target name="compile" depends="echo-properties">
    <mkdir dir="${build.classes.dir}"/>
    <javac srcdir="${src.dir}" destdir="${build.classes.dir}" debug="true" deprecation="true">
      <classpath>
        <path refid="compile.classpath"/>
      </classpath>
    </javac>
  </target>

  <target name="jar" depends="compile" description="deploy the plugin">
    <mkdir dir="${build.jars.dir}"/>
    <delete file="${build.jars.dir}/${jar.file}"/>
    <jar jarfile="${build.jars.dir}/${jar.file}">
      <fileset dir="${build.classes.dir}"/>
      <fileset dir=".">
        <include name="META-INF/plugin.xml"/>
      </fileset>
    </jar>

  </target>

  <target name="deploy" depends="jar" description="deploy the plugin">
    <mkdir dir="${idea.plugin.dir}"/>
    <copy file="${build.jars.dir}/${jar.file}" todir="${idea.plugin.dir}"/>
  </target>

  <target name="src" description="zips up all sources for distribution">
    <zip destfile="${project.name}_src.zip"
      basedir="."
      includes="src/** META-INF/** build.xml"
      excludes="CVS/**"
    />
	</target>
</project>
